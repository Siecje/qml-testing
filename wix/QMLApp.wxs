<?xml version="1.0"?>

<?define ProductName = "QML Application"?>
<?define ProductVersion = "1.0.0"?>
<!-- NEVER CHANGE THE upgrade_code BELOW!!!! -->
<?define ProductUpgradeCode = "6074df9e-e2b4-11e4-9e2c-005056c00009"?>
<?define ProductDescription = "QML Application"?>
<?define CompanyName = "Company"?>
<?define InstallDir = "QMLApplication"?>

<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" UpgradeCode="$(var.ProductUpgradeCode)" 
           Name="$(var.ProductName)" Version="$(var.ProductVersion)" Manufacturer="$(var.CompanyName)" Language="1033">
    <Package InstallerVersion="200" Compressed="yes" Comments="Windows Installer Package"/><!-- InstallScope="perUser" InstallPrivileges="limited"/> -->
    <Media Id="1" Cabinet="product.cab" EmbedCab="yes"/>
    <!-- <Icon Id="ProductIcon" SourceFile="example.ico"/> -->
    <Property Id="ARPPRODUCTICON" Value="ProductIcon"/>
    <Property Id="ARPHELPLINK" Value="http://www.exampleproduct.com"/>
    <Property Id="ARPURLINFOABOUT" Value="http://www.examplecompany.com"/>
    <Property Id="ARPNOREPAIR" Value="1"/>
    <Property Id="ARPNOMODIFY" Value="1"/>
    <Upgrade Id="$(var.ProductUpgradeCode)">
      <UpgradeVersion Minimum="$(var.ProductVersion)" OnlyDetect="yes" Property="NEWERVERSIONDETECTED"/>
      <UpgradeVersion Minimum="0.0.0" Maximum="$(var.ProductVersion)" IncludeMinimum="yes" IncludeMaximum="no" 
                      Property="OLDERVERSIONBEINGUPGRADED"/>
    </Upgrade>
    <Condition Message="A newer version of this software is already installed.">NOT NEWERVERSIONDETECTED</Condition>
 
    <Feature Id="ProgramFiles">
      <ComponentGroupRef Id="FromHeat" />
    </Feature>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <!-- <Directory Id="LocalAppDataFolder"> -->
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLDIR" Name="$(var.InstallDir)"></Directory>
      </Directory>
    </Directory>
 
    <InstallExecuteSequence>
      <RemoveExistingProducts After="InstallValidate"/>
    </InstallExecuteSequence>
    <!-- 
    <Feature Id="DefaultFeature" Level="1">
      <ComponentRef Id="ApplicationShortcuts"/>
    </Feature>
    -->
   </Product>
</Wix>
